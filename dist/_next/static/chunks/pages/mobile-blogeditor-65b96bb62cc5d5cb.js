(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[695],{11256:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mobile-blogeditor",function(){return n(55205)}])},55205:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return I}});var i=n(85893),a=n(67294),r=n(67952),s=n(5616),l=n(69417),o=n(15861),c=n(98456),d=n(81458),u=n(67720),x=n(87066),h=n(13950),m=n(64032),f=n(77294),g=n(91783),j=n(74187),p=n(2593),v=n(31065),b=n(10084),Z=n(76172),y=n(60888),k=n(19215),w=n(76770),_=n.n(w),S=n(16164);let C=e=>{let{setContent:t}=e,{quill:n,quillRef:r}=(0,S.p)({theme:"snow",placeholder:"",modules:{toolbar:{container:[["bold","italic"],["image"],[{align:[]}],[{color:[]}],["code-block"]]},clipboard:{matchVisual:!1}},formats:["bold","italic","underline","strike","align","list","indent","size","header","link","image","video","color","background","clean","code-block"]});(0,a.useEffect)(()=>{n&&(n.on("text-change",(e,i,a)=>{let r=n.getText().replace(/\n/g,"");r&&r.length>0?t(n.root.innerHTML):t("")}),n.getModule("toolbar").addHandler("image",l))},[n]);let s=()=>{if(n){let e=n.getContents(),t=e.ops.filter(e=>e.insert&&e.insert.image);return t.length}return 0};function l(){let e=s();if(e>=6){alert("You can only upload a maximum of 6 images.");return}let t=document.createElement("input");t.setAttribute("type","file"),t.setAttribute("accept","image/*"),t.click(),t.onchange=()=>{let e=t.files&&t.files[0];e&&_().imageFileResizer(e,800,800,"JPEG",80,0,e=>{if(n){var t;let i=n.getSelection(!0),a=null!==(t=null==i?void 0:i.index)&&void 0!==t?t:0;n.insertEmbed(a,"image",e),n.setSelection(a+1,0)}},"base64")}}return(0,i.jsx)("div",{className:"bodhi-editor",children:(0,i.jsx)("div",{ref:r})})};var E=n(11163);let F=()=>{let e=(0,E.useRouter)(),{refetchBodhiData:t}=(0,k.n)(),{type:n,close:r}=(0,m.a)(),{signer:w,account:_}=(0,v.Yh)(),[S,F]=(0,a.useState)(""),[I,L]=(0,a.useState)(""),[M,P]=(0,a.useState)(!1),[T,N]=(0,a.useState)(0),[z,A]=(0,a.useState)(0);async function W(){if(!S||""===S.trim()||"<p></p>"===S.trim()||"<p><br></p>"===S.trim()){(0,b.L)(!1,"Please enter text.");return}if(N(1),A(0),P(!0),""!==I&&I)setTimeout(()=>{D(I)},500);else try{let e=await x.Z.post(j.zA.api_text,{text:S});200===e.status?(L(e.data.transactionId),D(e.data.transactionId)):((0,b.L)(!1,"Upload failed. Please try again."),P(!1))}catch(e){console.error("Error uploading text:",e),P(!1)}let e=setInterval(()=>{A(e=>Math.min(e+10*Math.random(),100))},100);return()=>{clearInterval(e)}}async function D(n){if(!n||""==n||null==n)return;P(!0);let a=j.TT[j.KY].bodhi,r=new f.CH(a,g,w);try{let s={from:_,to:a,value:p.O$.from(0),data:r.interface.encodeFunctionData("create",[n])},l=await r.provider.estimateGas(s);console.log("gasLimit:",l.toNumber());let o=null==w?void 0:w.sendTransaction({...s,gasLimit:l});null==o||o.then(n=>{n.wait().then(a=>{if(1===a.status){let a=(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Bodhi Asset Posted."}),(0,i.jsxs)("p",{children:["tx:",n.hash]})]});(0,b.V)(!0,a),t&&t(),e.push("/")}else(0,b.L)(!1,"Signature failure.");P(!1)}).catch(e=>{P(!1),(0,b.L)(!1,e.reason)})}).catch(e=>{P(!1),(0,b.L)(!1,e.reason)})}catch(e){P(!1),-32603===e.code&&-32015==e.data.code?(0,b.L)(!1,"Insufficient funds for gas."):(0,b.L)(!1,"Signature failure.")}}return(0,i.jsxs)(i.Fragment,{children:[0==T&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.Z,{sx:{display:"flex",flexDirection:"column"},children:(0,i.jsx)(C,{setContent:F})}),(0,i.jsxs)(s.Z,{sx:{display:"flex",mt:4,justifyContent:"center",gap:4},children:[(0,i.jsx)(l.Z,{variant:"outlined",onClick:()=>{e.push("/")},sx:{minWidth:"90px"},startIcon:(0,i.jsx)(Z.Z,{}),children:(0,i.jsx)(o.Z,{variant:"buttonM",children:(0,i.jsx)(i.Fragment,{children:"Back "})})}),(0,i.jsx)(l.Z,{variant:"surface",onClick:()=>{W()},sx:{minWidth:"120px"},disabled:M,startIcon:M&&(0,i.jsx)(c.Z,{size:14}),children:(0,i.jsx)(o.Z,{variant:"buttonM",children:"Post now"})})]})]}),1==T&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.E,{title:"Space Preview"}),(0,i.jsx)(s.Z,{sx:{width:"100%"},children:100!=z?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(d.Z,{variant:"determinate",value:z})}):(0,i.jsxs)(s.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,i.jsxs)(o.Z,{variant:"main16",sx:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,i.jsx)(y.Z,{sx:{color:"#78e378"}}),(0,i.jsx)(i.Fragment,{children:"Uploaded"})]}),(0,i.jsxs)(o.Z,{variant:"secondary14",color:"text.secondary",children:["Arweave ID: ",I]}),(0,i.jsx)(u.Z,{sx:{mt:2,mb:2}}),(0,i.jsx)(o.Z,{variant:"secondary16",color:"text.primary",children:"Waiting for signing..."})]})}),(0,i.jsxs)(s.Z,{sx:{mt:8,display:"flex",justifyContent:"center",gap:4},children:[(0,i.jsx)(l.Z,{variant:"outlined",onClick:()=>{N(0),P(!1)},sx:{minWidth:"90px"},startIcon:(0,i.jsx)(Z.Z,{}),children:(0,i.jsx)(o.Z,{variant:"buttonM",children:(0,i.jsx)(i.Fragment,{children:"Back "})})}),(0,i.jsx)(l.Z,{variant:"surface",onClick:()=>{D(I)},sx:{minWidth:"90px"},disabled:M,startIcon:M&&(0,i.jsx)(c.Z,{size:14}),children:(0,i.jsx)(o.Z,{variant:"buttonM",children:(0,i.jsx)(i.Fragment,{children:M?"Signing":"Sign"})})})]})]})]})};function I(){return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(r.Z,{children:(0,i.jsx)(F,{})})})}}},function(e){e.O(0,[240,266,87,930,342,66,367,164,952,774,888,179],function(){return e(e.s=11256)}),_N_E=e.O()}]);