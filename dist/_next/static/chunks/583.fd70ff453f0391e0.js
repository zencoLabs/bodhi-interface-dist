"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[583],{67720:function(e,t,r){var i=r(63366),n=r(87462),s=r(67294),a=r(90512),o=r(58510),l=r(2101),c=r(90948),u=r(33616),d=r(35097),h=r(85893);let p=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],f=e=>{let{absolute:t,children:r,classes:i,flexItem:n,light:s,orientation:a,textAlign:l,variant:c}=e;return(0,o.Z)({root:["root",t&&"absolute",c,s&&"light","vertical"===a&&"vertical",n&&"flexItem",r&&"withChildren",r&&"vertical"===a&&"withChildrenVertical","right"===l&&"vertical"!==a&&"textAlignRight","left"===l&&"vertical"!==a&&"textAlignLeft"],wrapper:["wrapper","vertical"===a&&"wrapperVertical"]},d.V,i)},m=(0,c.ZP)("div",{name:"MuiDivider",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,r.absolute&&t.absolute,t[r.variant],r.light&&t.light,"vertical"===r.orientation&&t.vertical,r.flexItem&&t.flexItem,r.children&&t.withChildren,r.children&&"vertical"===r.orientation&&t.withChildrenVertical,"right"===r.textAlign&&"vertical"!==r.orientation&&t.textAlignRight,"left"===r.textAlign&&"vertical"!==r.orientation&&t.textAlignLeft]}})(({theme:e,ownerState:t})=>(0,n.Z)({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(e.vars||e).palette.divider,borderBottomWidth:"thin"},t.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},t.light&&{borderColor:e.vars?`rgba(${e.vars.palette.dividerChannel} / 0.08)`:(0,l.Fq)(e.palette.divider,.08)},"inset"===t.variant&&{marginLeft:72},"middle"===t.variant&&"horizontal"===t.orientation&&{marginLeft:e.spacing(2),marginRight:e.spacing(2)},"middle"===t.variant&&"vertical"===t.orientation&&{marginTop:e.spacing(1),marginBottom:e.spacing(1)},"vertical"===t.orientation&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},t.flexItem&&{alignSelf:"stretch",height:"auto"}),({ownerState:e})=>(0,n.Z)({},e.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,"&::before, &::after":{content:'""',alignSelf:"center"}}),({theme:e,ownerState:t})=>(0,n.Z)({},t.children&&"vertical"!==t.orientation&&{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(e.vars||e).palette.divider}`}}),({theme:e,ownerState:t})=>(0,n.Z)({},t.children&&"vertical"===t.orientation&&{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(e.vars||e).palette.divider}`}}),({ownerState:e})=>(0,n.Z)({},"right"===e.textAlign&&"vertical"!==e.orientation&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},"left"===e.textAlign&&"vertical"!==e.orientation&&{"&::before":{width:"10%"},"&::after":{width:"90%"}})),v=(0,c.ZP)("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.wrapper,"vertical"===r.orientation&&t.wrapperVertical]}})(({theme:e,ownerState:t})=>(0,n.Z)({display:"inline-block",paddingLeft:`calc(${e.spacing(1)} * 1.2)`,paddingRight:`calc(${e.spacing(1)} * 1.2)`},"vertical"===t.orientation&&{paddingTop:`calc(${e.spacing(1)} * 1.2)`,paddingBottom:`calc(${e.spacing(1)} * 1.2)`})),g=s.forwardRef(function(e,t){let r=(0,u.Z)({props:e,name:"MuiDivider"}),{absolute:s=!1,children:o,className:l,component:c=o?"div":"hr",flexItem:d=!1,light:g=!1,orientation:x="horizontal",role:b="hr"!==c?"separator":void 0,textAlign:y="center",variant:w="fullWidth"}=r,C=(0,i.Z)(r,p),S=(0,n.Z)({},r,{absolute:s,component:c,flexItem:d,light:g,orientation:x,role:b,textAlign:y,variant:w}),Z=f(S);return(0,h.jsx)(m,(0,n.Z)({as:c,className:(0,a.Z)(Z.root,l),role:b,ref:t,ownerState:S},C,{children:o?(0,h.jsx)(v,{className:Z.wrapper,ownerState:S,children:o}):null}))});g.muiSkipListHighlight=!0,t.Z=g},35097:function(e,t,r){r.d(t,{V:function(){return s}});var i=r(1977),n=r(8027);function s(e){return(0,n.ZP)("MuiDivider",e)}let a=(0,i.Z)("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]);t.Z=a},33286:function(e,t,r){r.d(t,{l:function(){return a}});var i=r(85893),n=r(67294),s=r(57333);let a=n.forwardRef(function(e,t){let{onChange:r,...n}=e;return(0,i.jsx)(s.Z,{...n,getInputRef:t,onValueChange:t=>{t.value!==e.value&&r({target:{name:e.name,value:t.value||""}})},thousandSeparator:!0,isNumericString:!0,allowNegative:!1})})},21583:function(e,t,r){r.r(t),r.d(t,{SpaceDistributionContent:function(){return j},SpaceDistributionModal:function(){return Z}});var i=r(85893),n=r(64032),s=r(15861),a=r(5616),o=r(67720),l=r(11298),c=r(87109),u=r(69417),d=r(98456),h=r(67294),p=r(47781),f=r(56836),m=r(31065),v=r(97975),g=r(49479),x=r(33286),b=r(10084),y=r(77294),w=r(35553),C=r(86012),S=r(19215);let Z=()=>{let{type:e,close:t}=(0,n.a)(),{tempSpaceModal:r}=(0,p.R)();async function a(){t()}return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(f.P,{open:e===n.w.SpaceDistribution,setOpen:a,contentMaxWidth:420,children:[(0,i.jsxs)(s.Z,{variant:"h2",sx:{mb:4},children:["Space #",null==r?void 0:r.spaceId]}),r&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(j,{tempSpaceModal:r})})]})})},j=e=>{var t,r,p,f;let{tempSpaceModal:Z}=e,{refetchBodhiData:j}=(0,S.n)(),{account:R,ethPrice:O,signer:D,getBuyPriceAfterFee:A}=(0,m.Yh)(),{close:F}=(0,n.a)(),{data:I,error:M}=(0,v.k)(Z.assetId,Z.assetSupply),[q,B]=(0,h.useState)(!1),[k,N]=(0,h.useState)(0);async function L(){B(!0);try{let e=Z.spaceAddress,t=new y.CH(e,C,D),r=A(Z.assetId,k,Z.assetSupply),i=w.fi(r.toString()),n=w.vz(k.toString(),18),s={from:R,to:e,value:i,data:t.interface.encodeFunctionData("buyback",[n])},a=await t.provider.estimateGas(s),o=null==D?void 0:D.sendTransaction({...s,gasLimit:a});null==o||o.then(e=>{e.wait().then(e=>{1===e.status?((0,b.L)(!0,"Confirm Success."),j&&j(),F()):(0,b.L)(!1,"Confirm failure."),B(!1)}).catch(e=>{B(!1),(0,b.L)(!1,e.reason)})}).catch(e=>{B(!1),(0,b.L)(!1,e.reason)})}catch(e){console.log(e),B(!1),-32603===e.code&&-32015==e.data.code?(0,b.L)(!1,"Insufficient funds for gas."):(0,b.L)(!1,"Confirm failure.")}}return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(a.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:2,mt:8},children:[(0,i.jsx)(s.Z,{variant:"secondary16",color:"text.secondary",children:"Avaliable to Distribute"}),(0,i.jsx)(g.B,{value:null!==(t=Z.totalFees)&&void 0!==t?t:0,compact:!0,visibleDecimals:4,symbol:"CFX",variant:"main21",color:"text.primary",symbolsColor:"text.primary"}),(0,i.jsx)(g.B,{value:null!==(r=Z.totalFees)&&void 0!==r?r:0*(null!=O?O:0),variant:"secondary16",compact:!0,visibleDecimals:3,symbol:"USD",color:"text.secondary",symbolsColor:"text.secondary"}),R&&R==Z.spaceCreator?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.Z,{sx:{mt:0,mb:2,width:"100%"}}),(0,i.jsxs)(a.Z,{sx:{display:"flex",flexDirection:"row",gap:2},children:[(0,i.jsx)(s.Z,{variant:"main16",color:"text.primary",children:"Current Price:"}),(0,i.jsx)(g.B,{value:null!=I?I:0,variant:"main16",symbolsVariant:"secondary14",compact:!0,visibleDecimals:3,symbol:"CFX/Share",symbolsColor:"text.primary"})]}),(0,i.jsx)(s.Z,{variant:"secondary16",color:"text.secondary",children:"Buy space share with its own revenue"}),(0,i.jsx)(a.Z,{sx:{width:"100%",display:"flex"},children:(0,i.jsx)(l.ZP,{sx:{flex:1,border:"1px solid #3c4454",borderRadius:1,padding:"4px 10px",backgroundColor:"#3f3d73"},placeholder:"0.00",value:k,autoFocus:!0,onChange:e=>{N(Number(e.target.value))},inputProps:{"aria-label":"amount input",style:{fontSize:"18px",lineHeight:"24,01px",height:"24px"}},endAdornment:(0,i.jsx)(c.Z,{position:"end",children:(0,i.jsx)(u.Z,{variant:"contained",onClick:()=>{N(Number(Z.totalFees))},sx:{minWidth:"20px",padding:"0px 4px"},children:"Max"})}),inputComponent:x.l})})]}):(0,i.jsx)(i.Fragment,{})]}),(0,i.jsx)(a.Z,{sx:{display:"flex",flexDirection:"column",mt:8},children:R&&R==Z.spaceCreator?(0,i.jsxs)(u.Z,{variant:null!==(p=null==Z?void 0:Z.totalFees)&&void 0!==p&&p?"surface":"contained",disabled:q,onClick:L,size:"large",sx:{borderRadius:2,minHeight:"44px"},"data-cy":"actionButton",children:[q&&(0,i.jsx)(d.Z,{color:"inherit",size:"16px",sx:{mr:2}}),q?"Signing":"Buyback"]}):(0,i.jsxs)(u.Z,{variant:null!==(f=null==Z?void 0:Z.totalFees)&&void 0!==f&&f?"surface":"contained",disabled:q||R!=Z.spaceCreator,size:"large",sx:{borderRadius:2,minHeight:"44px"},"data-cy":"actionButton",children:[q&&(0,i.jsx)(d.Z,{color:"inherit",size:"16px",sx:{mr:2}}),q?"Signing":"Distribute to Space Holders"]})}),(0,i.jsx)(a.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:2,mt:8},children:(0,i.jsx)(s.Z,{variant:"secondary16",color:"text.secondary",children:"How does distribution work?"})}),(0,i.jsx)(s.Z,{variant:"secondary14",color:"text.secondary",sx:{padding:"6px"},children:"Every space is a contract. When contract receives trading fees, it can use the funds to buy back its own shares, rewarding all holders. (Only space owner can trigger this action.)"})]})}},49479:function(e,t,r){r.d(t,{B:function(){return c}});var i=r(85893),n=r(70794);function s(e){return e instanceof n.O?e:new n.O(e)}n.O.clone({DECIMAL_PLACES:0,ROUNDING_MODE:n.O.ROUND_DOWN});var a=r(15861);let o=["","K","M","B","T","P","E","Z","Y"];function l(e){let{value:t,visibleDecimals:r=2}=e,n=s(t),a=n.toFixed(0).length,l=Math.min(Math.floor(a?(a-1)/3:0),o.length-1),c=o[l],u=s(n).shiftedBy(-1*(3*l)).toNumber();return(0,i.jsxs)(i.Fragment,{children:[new Intl.NumberFormat("en-US",{maximumFractionDigits:r,minimumFractionDigits:r}).format(u),c]})}function c(e){let{value:t,symbol:r,visibleDecimals:n,compact:s,percent:o,symbolsVariant:c,symbolsColor:u,...d}=e,h=o?100*Number(t):Number(t),p=n;0===h?p=0:void 0===n&&(p=h>1||o||"USD"===r?2:6);let f=10**-p,m=0!==h&&Math.abs(h)<Math.abs(f),v=m?f:h,g=!1!==s&&(s||h>99999);return(0,i.jsxs)(a.Z,{className:"formatted-number-apt",...d,sx:{display:"inline-flex",flexDirection:"row",alignItems:"center",position:"relative",...d.sx},noWrap:!0,children:[m&&(0,i.jsx)(a.Z,{component:"span",sx:{mr:.5},variant:c||d.variant,color:u||"text.secondary",children:"<"}),(null==r?void 0:r.toLowerCase())==="usd"&&!o&&(0,i.jsx)(a.Z,{component:"span",sx:{mr:.5},variant:c||d.variant,color:u||"text.secondary",children:"$"}),!g&&v>0?new Intl.NumberFormat("en-US",{maximumFractionDigits:p,minimumFractionDigits:p}).format(v):(0,i.jsx)(l,{value:v,visibleDecimals:p}),o&&(0,i.jsx)(a.Z,{component:"span",sx:{ml:.5},variant:c||d.variant,color:u||"text.secondary",children:"%"}),(null==r?void 0:r.toLowerCase())!=="usd"&&void 0!==r&&(0,i.jsx)(a.Z,{component:"span",sx:{ml:.5},variant:c||d.variant,color:u||"text.secondary",children:r})]})}},97975:function(e,t,r){r.d(t,{TX:function(){return d},bo:function(){return h},c1:function(){return l},k:function(){return u},lv:function(){return o},r2:function(){return c}});var i=r(31065),n=r(46154),s=r(99673),a=r(88144);let o=e=>{let t=(0,i.Yh)(e=>e.fetchArweaveData),r=(0,s.h)({queries:e.map(e=>({queryKey:["arweaveData",e],queryFn:()=>t(e),refetchInterval:6e4}))});return r},l=e=>{let{data:t,error:r}=(0,a.a)({queryKey:["useGetTransactionInfo",e],queryFn:()=>(0,n.Q1)(e),refetchInterval:6e4});return r?void 0:t},c=e=>{let t=(0,i.Yh)(e=>e.getBuyPrice),r=(0,s.h)({queries:e.map(e=>({queryKey:["getBuyPrice",e.assetId,e.totalSupply],queryFn:()=>t(e.assetId,1,e.totalSupply),refetchInterval:6e4}))});return r},u=(e,t)=>{let r=(0,i.Yh)(e=>e.getBuyPrice),{data:n,error:s}=(0,a.a)({queryKey:["getBuyPrice",e,t],queryFn:()=>r(e,1,t),refetchInterval:6e4});return{data:n,error:s}},d=(e,t,r)=>{let n=(0,i.Yh)(e=>e.getSellPrice),{data:s,error:o}=(0,a.a)({queryKey:["getSellPrice",e,t,r],queryFn:()=>n(e,1,t),refetchInterval:6e4});return{data:s,error:o}},h=(e,t,r)=>{let n=(0,i.Yh)(e=>e.getBalanceByAccount_Asset),{data:s,error:o}=(0,a.a)({queryKey:["getBalanceByAccount_Asset",t,e,r],queryFn:()=>n(e,t),refetchInterval:6e4});return{data:s,error:o}}},10084:function(e,t,r){r.d(t,{L:function(){return n},V:function(){return s}}),r(67294);var i=r(55678);function n(e,t){e?i.Am.success(t,{autoClose:5e3,position:"top-right",theme:"light",closeOnClick:!0,style:{borderRadius:"6px"}}):i.Am.error("".concat(t),{autoClose:2500,position:"top-right",theme:"light",closeOnClick:!0,style:{borderRadius:"6px"}})}function s(e,t){e?i.Am.success(t,{autoClose:5e3,position:"top-right",theme:"light",closeOnClick:!0,style:{borderRadius:"6px"}}):i.Am.error("".concat(t),{autoClose:2500,position:"top-right",theme:"light",closeOnClick:!0,style:{borderRadius:"6px"}})}},47781:function(e,t,r){r.d(t,{R:function(){return n}});var i=r(64529);let n=(0,i.Ue)(e=>({setTempAssetModal(t){e({tempAssetModal:t})},setTempSpaceModal(t){e({tempSpaceModal:t})},setTempSelectMemuIndex(t){e({tempSelectMemuIndex:t})}}))},46154:function(e,t,r){r.d(t,{Q1:function(){return s},fO:function(){return a}});var i=r(25733),n=r(74187);async function s(e){let t=new i.r(n.zG[n.KY].urls[0]),r=await t.getTransaction(e);return r}function a(e){return!!e&&!!e.spaceAddress&&""!=e.spaceAddress&&"0x0000000000000000000000000000000000000000"!=e.spaceAddress&&!!e.spaceName}},99673:function(e,t,r){r.d(t,{h:function(){return m}});var i=r(67294),n=r(27037),s=r(72536),a=r(7506),o=r(24139);function l(e,t){return e.filter(e=>!t.includes(e))}var c=class extends a.l{#e;#t;#r;#i;#n;#s;#a;constructor(e,t,r){super(),this.#e=e,this.#r=[],this.#i=[],this.#t=[],this.setQueries(t)}onSubscribe(){1===this.listeners.size&&this.#i.forEach(e=>{e.subscribe(t=>{this.#o(e,t)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#i.forEach(e=>{e.destroy()})}setQueries(e,t,r){this.#r=e,n.V.batch(()=>{let e=this.#i,t=this.#l(this.#r);t.forEach(e=>e.observer.setOptions(e.defaultedQueryOptions,r));let i=t.map(e=>e.observer),n=i.map(e=>e.getCurrentResult()),s=i.some((t,r)=>t!==e[r]);(e.length!==i.length||s)&&(this.#i=i,this.#t=n,this.hasListeners()&&(l(e,i).forEach(e=>{e.destroy()}),l(i,e).forEach(e=>{e.subscribe(t=>{this.#o(e,t)})}),this.#c()))})}getCurrentResult(){return this.#t}getQueries(){return this.#i.map(e=>e.getCurrentQuery())}getObservers(){return this.#i}getOptimisticResult(e,t){let r=this.#l(e),i=r.map(e=>e.observer.getOptimisticResult(e.defaultedQueryOptions));return[i,e=>this.#u(e??i,t),()=>r.map((e,t)=>{let n=i[t];return e.defaultedQueryOptions.notifyOnChangeProps?n:e.observer.trackResult(n,e=>{r.forEach(t=>{t.observer.trackProp(e)})})})]}#u(e,t){return t?(this.#n&&this.#t===this.#a&&t===this.#s||(this.#s=t,this.#a=this.#t,this.#n=(0,o.Q$)(this.#n,t(e))),this.#n):e}#l(e){let t=this.#i,r=new Map(t.map(e=>[e.options.queryHash,e])),i=e.map(e=>this.#e.defaultQueryOptions(e)),n=i.flatMap(e=>{let t=r.get(e.queryHash);return null!=t?[{defaultedQueryOptions:e,observer:t}]:[]}),a=new Set(n.map(e=>e.defaultedQueryOptions.queryHash)),o=i.filter(e=>!a.has(e.queryHash)),l=e=>{let t=this.#e.defaultQueryOptions(e),r=this.#i.find(e=>e.options.queryHash===t.queryHash);return r??new s.z(this.#e,t)},c=o.map(e=>({defaultedQueryOptions:e,observer:l(e)}));return n.concat(c).sort((e,t)=>i.indexOf(e.defaultedQueryOptions)-i.indexOf(t.defaultedQueryOptions))}#o(e,t){let r=this.#i.indexOf(e);-1!==r&&(this.#t=function(e,t,r){let i=e.slice(0);return i[t]=r,i}(this.#t,r,t),this.#c())}#c(){n.V.batch(()=>{this.listeners.forEach(e=>{e(this.#t)})})}},u=r(30202),d=r(2762),h=r(37323),p=r(9160),f=r(44590);function m({queries:e,...t},r){let a=(0,u.NL)(r),o=(0,d.S)(),l=(0,h._)(),m=i.useMemo(()=>e.map(e=>{let t=a.defaultQueryOptions(e);return t._optimisticResults=o?"isRestoring":"optimistic",t}),[e,a,o]);m.forEach(e=>{(0,f.Fb)(e),(0,p.pf)(e,l)}),(0,p.JN)(l);let[v]=i.useState(()=>new c(a,m,t)),[g,x,b]=v.getOptimisticResult(m,t.combine);i.useSyncExternalStore(i.useCallback(e=>o?()=>void 0:v.subscribe(n.V.batchCalls(e)),[v,o]),()=>v.getCurrentResult(),()=>v.getCurrentResult()),i.useEffect(()=>{v.setQueries(m,t,{listeners:!1})},[m,t,v]);let y=g.some((e,t)=>(0,f.SB)(m[t],e)),w=y?g.flatMap((e,t)=>{let r=m[t];if(r){let t=new s.z(a,r);if((0,f.SB)(r,e))return(0,f.j8)(r,t,l);(0,f.Z$)(e,o)&&(0,f.j8)(r,t,l)}return[]}):[];if(w.length>0)throw Promise.all(w);let C=g.find((e,t)=>{let r=m[t];return r&&(0,p.KJ)({result:e,errorResetBoundary:l,throwOnError:r.throwOnError,query:a.getQueryCache().get(r.queryHash)})});if(C?.error)throw C.error;return x(b())}}}]);